# N1インタビュー分析システム 仕様書

### 1. 概要
本仕様書は、「N1インタビュー分析システム要件定義書」に基づき、システムの具体的な技術仕様、機能詳細、画面設計を定義する。

### 2. システム構成図
```mermaid
graph TD
    A[ユーザー] -->|1. 音声ファイルアップロード| B(フロントエンド / Web UI);
    B -->|2. 音声データ送信| C(バックエンド / APIサーバ);
    C -->|3. 文字起こし依頼| D[音声認識API (例: OpenAI Whisper)];
    D -->|4. タイムスタンプ付きテキスト返却| C;
    C -->|5. 分析プロンプトと共にテキスト送信| E[Grok API];
    E -->|6. 分析結果(JSON/Text)返却| C;
    C -->|7. 整形済みデータ送信| B;
    B -->|8. 分析結果表示| A;
Use code with caution.
Markdown
3. 機能仕様詳細
3.1. 音声データ入力機能 (F-01)
対応フォーマット: MP3, WAV, M4A
ファイルサイズ上限: 200MB
UI: ドラッグ＆ドロップおよびファイル選択ダイアログによるアップロードインターフェース。
3.2. 自動文字起こし機能 (F-02)
使用API: OpenAI Whisper API (largeモデル) もしくは同等のタイムスタンプ精度を持つAPIを利用。
出力形式: 発言単位で開始・終了タイムスタンプが付与されたデータ構造（例: JSON）。
{
  "segments": [
    { "start": 12.34, "end": 15.67, "text": "..." },
    { "start": 16.01, "end": 20.45, "text": "..." }
  ]
}
Use code with caution.
Json
3.3. N1分析実行機能 (F-03)
使用API: Grok API
送信データ:
プロンプト: 以下のプロンプトを固定で利用する。
## ロール
あなたは経験豊富なマーケティングリサーチャーです。
N1 インタビューの書き起こしを読み、
「購入前から N1 が知っていた情報（既存認知）」と
「購入を決めるきっかけになった新しい情報（新認知）」に分類してください。

## 目的
- インタビュー内容を正確に分類し、
  商品開発・訴求改善に活かせるインサイトを抽出する。

## 手順
1. インタビュー全体を精読する。
2. 発言ごとに「情報・気付き・価値観」を抽出する。
3. それぞれが **購入前に既に持っていた認識** か **購入を後押しした新しい認識** かを判断する。
   - 迷う場合は両方に入れず「判定保留」として残す。
4. 引用箇所（タイムスタンプ）を示す。
5. 端的かつ重複のない表現にまとめる。

## 出力形式
### ◆既存認知（購入前に知っていた情報）
- 【00:12】◯◯◯◯
- 【02:45】◯◯◯◯
（箇条書きで 3–10 個程度、重要度が高い順にまとめる）

### ◆新認知（購入動機となった新しい情報）
- 【05:18】◯◯◯◯
- 【11:02】◯◯◯◯
（同上）

### ◆判定保留（いずれにも明確に当てはまらない発言）
- 【13:30】◯◯◯◯

## 分析対象の書き起こし
{ここにタイムスタンプ付き文字起こしテキストを挿入}
Use code with caution.
Text
文字起こしテキストの形式: タイムスタンプ 【HH:MM:SS】 と発言を交互に配置した平文テキストを生成し、プロンプトの末尾に結合する。
例: 【00:12:34】発言内容テキスト...
3.4. 分析結果出力機能 (F-04)
入力: Grok APIからのMarkdown形式のレスポンス。
処理: APIレスポンスをそのまま表示エリアにレンダリングする。### や - などのMarkdown記法を正しく解釈して表示する。
4. 画面仕様（ワイヤーフレーム）
画面構成: 単一ページのシンプルな構成。
上部: ①音声ファイルアップロードエリア
中央: ②「分析実行」ボタン（アップロード完了後に活性化）
下部: ③分析結果表示エリア（処理中はローディング表示、完了後に結果とコピーボタンを表示）
5. 使用技術スタック（案）
フロントエンド: Next.js (or Vue.js)
バックエンド: Python (FastAPI) or Node.js (Express)
インフラ: AWS (S3, Lambda, API Gateway) or Google Cloud (Cloud Storage, Cloud Functions)
音声認識API: OpenAI Whisper API
LLM API: Grok API
